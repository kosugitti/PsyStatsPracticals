# 線形モデルの展開

この章では，線形モデルの展開を説明する。線形モデルは，説明変数と目的変数の関係を線形すなわち一次式で表現するモデルである。
線形モデルは，一般化線形モデル(GLM)，一般化線形混合モデル(GLMM)，階層線形モデル(HLM)と拡張していくが，まずは一般線形モデル(LM)についてみておこう。

## 一般線形モデル(General Linear Model)

線形モデルの基本は回帰分析モデルである。単回帰モデルは次の式で表される。

$$
y_i = \beta_0 + \beta_1 x + e_i
$$

ここで，$y_i$は$i$番目の観測値，$\beta_0$は切片，$\beta_1$は回帰係数，$e_i$は誤差項である。
この式を拡張したのが重回帰分析で，次の式で表される。

$$
y_i = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p + e_i
$$

ここで，$x_1, x_2, \cdots, x_p$は説明変数，$\beta_1, \beta_2, \cdots, \beta_p$は回帰係数である。

この式をベクトルと行列で表現すると，次のようになる。

$$
y = X\beta + e
$$

ここで，$y$は$n$次元のベクトル，$X$は$n \times p$の**計画行列**(design matrix)，$\beta$は$p$次元のベクトル，$e$は$n$次元のベクトルである。

計画行列は，説明変数のデータをまとめた行列であり，次のようになる。

$$
X = \begin{pmatrix}
1 & x_1 & x_2 & \cdots & x_p\\
1 & x_1 & x_2 & \cdots & x_p\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & x_1 & x_2 & \cdots & x_p
\end{pmatrix}
$$

第一列目にあるのは切片にかかる係数であり，第二列目以降にあるのは説明変数にかかる係数である。
ここに係数ベクトル$\beta= (\beta_0, \beta_1, \beta_2, \cdots, \beta_p)^T$をかけることで，説明変数の線形結合が得られる。


## 一般化線形モデル(GLM)
## 一般化線形混合モデル(GLMM)
## 階層線形モデル(HLM)


