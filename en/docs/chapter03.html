<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Psychological Statistics - 3&nbsp; Data Handling with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter04.html" rel="next">
<link href="./chapter02.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter03.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Handling with R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Psychological Statistics</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Introduction-to-Psychological-Statistics.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Introduction-to-Psychological-Statistics.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Let’s Start with R/RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentals of R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter03.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Handling with R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating Reports with R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Programming with R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Probability and Simulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing (Null Hypothesis Statistical Testing)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Testing of Mean Difference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Test of the Difference in Mean Values of Multiple Groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Simulation of Null Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basics of Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Expanding Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Multivariate Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-tidyverse" id="toc-introduction-to-tidyverse" class="nav-link active" data-scroll-target="#introduction-to-tidyverse"><span class="header-section-number">3.1</span> Introduction to tidyverse</a></li>
  <li><a href="#pipe-operator" id="toc-pipe-operator" class="nav-link" data-scroll-target="#pipe-operator"><span class="header-section-number">3.2</span> Pipe Operator</a></li>
  <li><a href="#assignment-1" id="toc-assignment-1" class="nav-link" data-scroll-target="#assignment-1"><span class="header-section-number">3.3</span> Assignment 1</a></li>
  <li><a href="#column-selection-and-row-selection" id="toc-column-selection-and-row-selection" class="nav-link" data-scroll-target="#column-selection-and-row-selection"><span class="header-section-number">3.4</span> Column Selection and Row Selection</a>
  <ul class="collapse">
  <li><a href="#column-selection" id="toc-column-selection" class="nav-link" data-scroll-target="#column-selection"><span class="header-section-number">3.4.1</span> Column Selection</a></li>
  <li><a href="#row-selection" id="toc-row-selection" class="nav-link" data-scroll-target="#row-selection"><span class="header-section-number">3.4.2</span> Row Selection</a></li>
  </ul></li>
  <li><a href="#creating-and-reassigning-variables" id="toc-creating-and-reassigning-variables" class="nav-link" data-scroll-target="#creating-and-reassigning-variables"><span class="header-section-number">3.5</span> Creating and Reassigning Variables</a></li>
  <li><a href="#assignment-2" id="toc-assignment-2" class="nav-link" data-scroll-target="#assignment-2"><span class="header-section-number">3.6</span> Assignment 2</a></li>
  <li><a href="#long-format-and-wide-format" id="toc-long-format-and-wide-format" class="nav-link" data-scroll-target="#long-format-and-wide-format"><span class="header-section-number">3.7</span> Long Format and Wide Format</a></li>
  <li><a href="#grouping-and-summary-statistics" id="toc-grouping-and-summary-statistics" class="nav-link" data-scroll-target="#grouping-and-summary-statistics"><span class="header-section-number">3.8</span> Grouping and Summary Statistics</a></li>
  <li><a href="#data-shaping-task" id="toc-data-shaping-task" class="nav-link" data-scroll-target="#data-shaping-task"><span class="header-section-number">3.9</span> Data Shaping Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Handling with R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In psychology and other sciences dealing with data, there’s a procedure that exists between planning and executing data collection, and the analysis of results based on data - this process involves “processing the data into an understandable form, visualizing it, and analyzing it”. This processing of data is referred to as <strong>data handling</strong>. Although the emphasis often falls on ‘analysis’ when talking about statistics, in actuality the steps of data handling and visualization are the most time-consuming and therefore crucial processes.</p>
<section id="introduction-to-tidyverse" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction-to-tidyverse"><span class="header-section-number">3.1</span> Introduction to tidyverse</h2>
<p>In this lecture, we will cover data handling using <code>tidyverse</code>. <code>Tidyverse</code> is both a conceptual design principle for dealing with data and specifically the name of the package implementing this principle. First, install (download) the <code>tidyverse</code> package and load it into R using the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>You will see a message stating “Attaching core tidyverse packages,” followed by a list with checkmarks next to multiple package names. The <code>tidyverse</code> package is a group of packages that includes these subsidiary packages. Among them, the <code>dplyr</code> and <code>tidyr</code> packages are used for data manipulation, <code>readr</code> for file input, <code>forcats</code> for manipulating factor variables, <code>stringr</code> for manipulating character variables, <code>lubridate</code> for working with date variables, <code>tibble</code> for handling data frame objects, <code>purrr</code> for functions applied to data, and <code>ggplot2</code> is a specialized package for data visualization.</p>
<p>Next, we need to address Conflicts. This warning message, which can appear when loading any package, not just the <code>tidyverse</code> package, is referring to a “function name conflict”. Up until now, we’ve been able to use functions like <code>sqrt</code> and <code>mean</code> just by starting R. These are basic functions in R, or more specifically, functions included in the <code>base</code> package. R automatically loads several packages, including <code>base</code>, when it starts. When we load additional packages, sometimes the later-loaded package uses a function with the same name. When this happens, the function name gets overwritten by the later one. The warning message is informing you about this. So, specifically when we see <code>dplyr::filter() masks stats::filter()</code>, it means that the <code>filter</code> function from the originally loaded <code>stats</code> package has been overwritten by the function of the same name in the <code>dplyr</code> package (which is part of <code>tidyverse</code>). From now on, the latter will be the one used primarily. This warning is giving you a heads up about that.</p>
<p>Functions with the same pronunciation but different spellings may cause confusion when trying to identify a specific function. If you want to specify that a function is part of a certain package, it’s best to write it as shown in this warning message: packageName<code>::</code>functionName.</p>
</section>
<section id="pipe-operator" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="pipe-operator"><span class="header-section-number">3.2</span> Pipe Operator</h2>
<p>Next, we will explain the pipe operator. The pipe operator was introduced in the <code>magrittr</code> package, which is included in the <code>tidyverse</code> package, and it has dramatically improved the convenience of data handling. So, from version 4.2 onwards, R incorporated this operator, making it usable without needing to install any specific packages. This pipe operator included in the body of R is sometimes referred to as a “naive pipe” to distinguish it from the one in <code>tidyverse</code>.</p>
<p>Let’s start off by explaining how excellent this pipe operator is. The following script calculates the standard deviation of a particular dataset<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. In mathematical terms, it can be expressed as follows. Here, <span class="math inline">\(\bar {x}\)</span> represents the arithmetic mean of the data vector <span class="math inline">\(x\)</span>. This formula computes the standard deviation, represented by “v”, of a data set. To understand this formula, let’s start with ‘x_i’, which are individual data points. ‘x̄’ represents the mean (the average of all the data points).</p>
<p>The equation inside the bracket (x_i - x̄) calculates how much each data point deviates from the mean. This value is then squared to ensure that all deviations are positive (since deviations can be either below or above the average).</p>
<p>Next, the sum of these squared deviations is calculated by the sigma sign Σ, which shows that we sum over all data points from ‘i = 1’ to ‘n’ (n being the total number of data points).</p>
<p>This sum is then divided by ‘n’, which averages the squared deviations. The square root of this average is taken (as represented by the square root sign), which gives us the standard deviation ‘v’. This is a measure of the dispersion or variability in your data. More simply, it tells us how spread out our data is around the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">14</span>) <span class="co"># データ</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat) <span class="co"># 平均</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dev <span class="ot">&lt;-</span> dat <span class="sc">-</span> M <span class="co"># 平均偏差</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> dev<span class="sc">^</span><span class="dv">2</span> <span class="co"># 平均偏差の2乗</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span> <span class="fu">mean</span>(pow) <span class="co"># 平均偏差の2乗の平均が分散</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>standardDev <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(variance) <span class="co"># 分散の正の平方根が標準偏差</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this section, we’ve arrived at the answer by creating four different objects: the mean object <code>M</code>, the mean deviation vector <code>dev</code>, its squared version <code>pow</code>, and the variance <code>variance</code>, all culminating in the standard deviation object <code>standardDev</code>. Also, because the objects being created are on the left and the operations being performed are described on the right, you’ll likely read and comprehend it in your mind as “create an object, then do the following calculation.”</p>
<p>The pipe operator embodies this flow of thought. The pipe operator is written as <code>%&gt;%</code>, and its role is to pass the result of the operation on the left as the first argument to the function that comes on the right side of the pipe operator. With this in mind, let’s rewrite the above script. By the way, you can input the pipe operator using the shortcut <code>Ctrl(Cmd)+Shift+M</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">14</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>standardDev <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    . <span class="sc">-</span> <span class="fu">mean</span>(.)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  } <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  } <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The period (<code>.</code>) here is a placeholder inherited from the previous function. The second line, <code>{dat - mean(dat)}</code>, represents the calculation of the mean deviation. This is then squared, averaged, and square-rooted in the next pipe. The reason why the placeholder is not specified when taking the mean or square root is because it is omitted since it is clear where the received arguments will be placed.</p>
<p>As seen in this example, using the pipe operator makes it easier to understand the process, as it aligns the flow of computation—data <span class="math inline">\(\to\)</span> mean deviation <span class="math inline">\(\to\)</span> squaring <span class="math inline">\(\to\)</span> averaging <span class="math inline">\(\to\)</span> square root—and the flow of the script. Doesn’t it become more comprehensible this way?</p>
<p>Additionally, the calculations here can also be written as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>standardDev <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((dat <span class="sc">-</span> <span class="fu">mean</span>(dat))<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This writing style introduces the concept of nesting, where a function is placed within another function, such as <span class="math inline">\(y = h(g(f(x)))\)</span>. Understanding this requires reading from the innermost parentheses, which can be difficult because the thought process is reversed. By using the pipe operator, we can represent the same sequence as <code>x %&gt;% f() %&gt;% g() %&gt;% h() -&gt; y</code>, thus making it easier to read and comprehend.</p>
<p>We will proceed using this pipe operator notation, so let’s get accustomed to this notation (and its shortcuts).</p>
</section>
<section id="assignment-1" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="assignment-1"><span class="header-section-number">3.3</span> Assignment 1</h2>
<ul>
<li>Let’s try to check with the help function if <code>sqrt</code> and <code>mean</code> are included in the <code>base</code> package. Where should we look? What about the <code>filter</code> and <code>lag</code> functions?</li>
<li>By loading the <code>tidyverse</code> package, the <code>filter</code> function from the <code>dplyr</code> package is now given priority. Let’s take a look at the <code>filter</code> function in the <code>dplyr</code> package using the help function. Let’s take a look at the help option for the <code>filter</code> function in the <code>stats</code> package before it gets overwritten.</li>
<li>Let’s use the data we have recently collected to compute the Mean Absolute Deviation (MeanAD) and the Median Absolute Deviation (MAD) using pipe operators. These deviations are defined as follows. Also, the R function to calculate the absolute value is <code>abs</code>.</li>
</ul>
<p>“MeanAD = 1/n * Σ from i=1 to n (absolute value of x_i - x_bar)”</p>
<p>This formula represents the calculation of the Mean Absolute Deviation (MeanAD), a measure in statistics that shows the dispersion of set data points. Here, ‘n’ is the number of data points, ‘x_i’ is each individual data point, and ‘x_bar’ is the mean (average) of those data points. The absolute difference between each data point and the mean is calculated and then summed up. This total is divided by the number of data points to get the mean absolute deviation. Thus, it gives us an average of how much deviation there is from the mean in our dataset, which can provide useful insights for data analysis. The above formula represents the Median Absolute Deviation (MAD). It is a measure of statistical dispersion. In layman’s terms, it gives us an idea about the variability in a data set.</p>
<p>The equation is: <span class="math display">\[MAD= median(|x_1-median(x)|,...,|x_n-median(x)|)\]</span></p>
<p>Let’s break it down:</p>
<p>In the formula, “x_1,…,x_n” represents all of the values in the data set. The difference between each value “x” and the median of the whole data set is denoted as “|x-median(x)|”.</p>
<p>The “median” function in front implies that we calculate the median of all these absolute differences.</p>
<p>In simpler words, the MAD essentially calculates the distance from each data point in the set to the median. After these distances are calculated, the MAD is the median of these distances. This gives us a reliable statistic for the variation in our data set, as the MAD is not affected by outliers or extreme values.</p>
<p>Remember to use well-documented libraries or packages when calculating the MAD in R or RStudio, as it makes your work easier and error-free. Try to play around with this concept in RStudio to gain more understanding. Don’t be afraid to make mistakes; learners often learn the most after debugging!</p>
</section>
<section id="column-selection-and-row-selection" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="column-selection-and-row-selection"><span class="header-section-number">3.4</span> Column Selection and Row Selection</h2>
<p>From here on, we will discuss more concrete data handling using <code>tidyverse</code>. Let’s start by considering how to extract specific rows and columns. This will be very useful when you want to apply operations to only a portion of your data.</p>
<section id="column-selection" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="column-selection"><span class="header-section-number">3.4.1</span> Column Selection</h3>
<p>Column selection is done using the <code>select</code> function. This is included in the <code>dplyr</code> package within the <code>tidyverse</code> package. Be careful with the <code>select</code> function; it is often included in other packages like <code>MASS</code>, so it’s important to pay attention to potential naming conflicts.</p>
<p>To illustrate, we will use the default sample data in R, <code>iris</code>. Please note, the <code>iris</code> dataset comprises 150 rows. Here, we use the <code>head</code> function to display the beginning of the dataset. However, it’s not necessary to use <code>head</code> during practice exercises.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># irisデータの確認</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 一部の変数を抜き出す</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Length, Species) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Species
1          5.1  setosa
2          4.9  setosa
3          4.7  setosa
4          4.6  setosa
5          5.0  setosa
6          5.4  setosa</code></pre>
</div>
</div>
<p>Conversely, if you want to exclude some variables, you can prefix them with a minus sign.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2
4          4.6         3.1          1.5         0.2
5          5.0         3.6          1.4         0.2
6          5.4         3.9          1.7         0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 複数変数の除外</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Petal.Length, Petal.Width)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Species
1          5.1         3.5  setosa
2          4.9         3.0  setosa
3          4.7         3.2  setosa
4          4.6         3.1  setosa
5          5.0         3.6  setosa
6          5.4         3.9  setosa</code></pre>
</div>
</div>
<p>This alone is useful, but the <code>select</code> function is even better because you can specify the conditions for extracting data when applying it. Here are some handy functions for this purpose.</p>
<p>I’m sorry, but you haven’t provided any Japanese text to be translated. Could you please provide the text? It seems like you forgot to provide the Japanese text for translation. Please provide the text so I can assist you better. I’m sorry but you haven’t provided any Japanese text for me to translate. Please provide the text you would like translated. I’m sorry, but you haven’t provided a Japanese text to translate. Could you please provide the text you need translated?</p>
<p>Here are some examples of its usage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># starts_withで特定の文字から始まる変数を抜き出す</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Petal"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length Petal.Width
1          1.4         0.2
2          1.4         0.2
3          1.3         0.2
4          1.5         0.2
5          1.4         0.2
6          1.7         0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ends_withで特定の文字で終わる変数を抜き出す</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"Length"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Petal.Length
1          5.1          1.4
2          4.9          1.4
3          4.7          1.3
4          4.6          1.5
5          5.0          1.4
6          5.4          1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># containsで部分一致する変数を取り出す</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"etal"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length Petal.Width
1          1.4         0.2
2          1.4         0.2
3          1.3         0.2
4          1.5         0.2
5          1.4         0.2
6          1.7         0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matchesで正規表現による選択をする</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">".t."</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2
4          4.6         3.1          1.5         0.2
5          5.0         3.6          1.4         0.2
6          5.4         3.9          1.7         0.4</code></pre>
</div>
</div>
<p>The <strong>regular expression</strong> mentioned here is a set of notation rules used to specify a pattern for identifying strings. It is applied not only in the R language, but in general programming languages as well. It is often used in bibliographic searches and allows the representation of arbitrary strings, beginning and ending words, etc., using symbols (metacharacters). For more information, it would be beneficial to search for “regular expression.” For example, <a href="https://userweb.mnet.ne.jp/nakama/">this website</a> provides an understandable introduction.</p>
</section>
<section id="row-selection" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="row-selection"><span class="header-section-number">3.4.2</span> Row Selection</h3>
<p>In general, as variables are lined up in columns in a data frame, selecting columns with the <code>select</code> function can also be referred to as variable selection. In contrast, since observations are arranged in rows, row selection refers to the selection of observations (cases, individuals). The <code>filter</code> function from <code>dplyr</code> is used for row selection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sepal.Length変数が6以上のケースを抜き出す</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sepal.Length <span class="sc">&gt;</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1          7.0         3.2          4.7         1.4 versicolor
2          6.4         3.2          4.5         1.5 versicolor
3          6.9         3.1          4.9         1.5 versicolor
4          6.5         2.8          4.6         1.5 versicolor
5          6.3         3.3          4.7         1.6 versicolor
6          6.6         2.9          4.6         1.3 versicolor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 特定の種別だけ抜き出す</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"versicolor"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1          7.0         3.2          4.7         1.4 versicolor
2          6.4         3.2          4.5         1.5 versicolor
3          6.9         3.1          4.9         1.5 versicolor
4          5.5         2.3          4.0         1.3 versicolor
5          6.5         2.8          4.6         1.5 versicolor
6          5.7         2.8          4.5         1.3 versicolor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 複数指定の例</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">"versicolor"</span>, Sepal.Length <span class="sc">&gt;</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
1          6.3         3.3          6.0         2.5 virginica
2          7.1         3.0          5.9         2.1 virginica
3          6.3         2.9          5.6         1.8 virginica
4          6.5         3.0          5.8         2.2 virginica
5          7.6         3.0          6.6         2.1 virginica
6          7.3         2.9          6.3         1.8 virginica</code></pre>
</div>
</div>
<p>What you see as <code>==</code> here is an operator to determine if things are equal. If there’s only one <code>=</code>, it would mean ‘assign to an object’, so we use <code>==</code> to denote the condition of equality. Similarly, <code>!=</code> is an operator that becomes true when things are not equal, meaning ‘not equal’.</p>
</section>
</section>
<section id="creating-and-reassigning-variables" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="creating-and-reassigning-variables"><span class="header-section-number">3.5</span> Creating and Reassigning Variables</h2>
<p>Creating a new variable from an existing one or reassigning values is one of the most common operations when handling data. For instance, you might take a continuous variable and transform it into a categorical one, such as “high group/low group,” based on a certain value. Or, you might perform a linear transformation to change units. When you want to manipulate variables in this way — taking an existing variable and process it to create a feature — the operation is typically done using the <code>mutate</code> function in <code>dplyr</code>. Let’s take a look at the following example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(iris, <span class="at">Twice =</span> Sepal.Length <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species Twice
1          5.1         3.5          1.4         0.2  setosa  10.2
2          4.9         3.0          1.4         0.2  setosa   9.8
3          4.7         3.2          1.3         0.2  setosa   9.4
4          4.6         3.1          1.5         0.2  setosa   9.2
5          5.0         3.6          1.4         0.2  setosa  10.0
6          5.4         3.9          1.7         0.4  setosa  10.8</code></pre>
</div>
</div>
<p>You should be able to confirm that a new variable <code>Twice</code> has been created. This function can be used within the pipe operator (in fact, this is its primary use). The following example divides the <code>Sepal.Length</code> variable into two groups: a high group and a low group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Length) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sepal.HL =</span> <span class="fu">ifelse</span>(Sepal.Length <span class="sc">&gt;</span> <span class="fu">mean</span>(Sepal.Length), <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sepal.HL =</span> <span class="fu">factor</span>(Sepal.HL, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Low"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.HL
1          5.1      Low
2          4.9      Low
3          4.7      Low
4          4.6      Low
5          5.0      Low
6          5.4      Low</code></pre>
</div>
</div>
<p>The <code>ifelse</code> function used here is a conditional branching function, which is in the form of <code>if(condition, process when true, process when false)</code>. In this case, it is set up to return 1 if the value is greater than the average and 2 otherwise. The function <code>mutate</code> assigns (generates) this result to the Sepal.HL variable. The next <code>mutate</code> function converts the Sepal.HL variable we just created into a Factor type, and this result is also assigned (overwritten) to the Sepal.HL variable. In this way, when the destination for generating the variable is the same as the source, the variable is overwritten. This method can be utilized when converting the type of a variable (e.g., from character type to numeric type, from numeric type to Factor type, etc.).</p>
</section>
<section id="assignment-2" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="assignment-2"><span class="header-section-number">3.6</span> Assignment 2</h2>
<p>Let’s load the <code>Baseball.csv</code> and assign it to the dataframe <code>df</code>. + <code>df</code> contains multiple variables. You can list out the variable names using the <code>names</code> function. Let’s check the variable names contained in the <code>df</code> object.</p>
<ul>
<li>There are many variables in <code>df</code>, but all we need are the Year (<code>Year</code>), Player’s Name (<code>Name</code>), Team (<code>team</code>), Height (<code>height</code>), Weight (<code>weight</code>), Salary (<code>salary</code>), and Defensive Position (<code>position</code>). Let’s select these variables and create a <code>df2</code> object that consists only of these variables.</li>
<li>The data in <code>df2</code> contains information spanning several years. If you want to analyze only the data for <code>fiscal year 2020</code>, let’s try to sort it out. Let’s try to select only the data related to the <code>Hanshin Tigers</code> from the <code>2020 fiscal year</code>.</li>
<li>How can we filter the dataset to exclude the <code>Hanshin Tigers</code> from the <code>2020 fiscal year</code>? Let’s create a BMI variable to represent the physical characteristics of the athletes. Note that BMI is calculated by dividing the weight (kg) by the square of the height (m). Be aware that the unit of the <code>height</code> variable is in cm.</li>
<li>Let’s create a new variable called <code>position2</code> to distinguish between pitchers and fielders. This will be set as a Factor type. Note that a fielder is anything other than a pitcher; that is, either an infielder, an outfielder, or a catcher. The professional baseball league in Japan is broadly divided into the Central League (CL) and the Pacific League (PL). Teams in the Central League include the Giants, Carp, Tigers, Swallows, Dragons, and DeNA, while the Pacific League comprises the remainder. Let’s modify <code>df2</code> to create a new <code>League</code> variable representing the league each team belongs to. Make sure to designate this variable as a Factor type.</li>
<li>The variable <code>Year</code> is currently a character type because it contains the suffix “年度” (Japanese for “fiscal year”). This can be inconvenient when we actually use it. Let’s convert it into a numerical type by removing the “年度” characters.</li>
</ul>
</section>
<section id="long-format-and-wide-format" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="long-format-and-wide-format"><span class="header-section-number">3.7</span> Long Format and Wide Format</h2>
<p>The data we’ve seen so far has been stored in a two-dimensional matrix form, arranged as case by variable. This format is easy for humans to understand and manage, but it’s not necessarily the same for computers. For instance, sometimes people tend to misuse spreadsheet software, like Excel (often humorously referred to as “God Excel”), treating it as graph paper or manuscript paper. This format may be easy for humans to interpret (since it’s visually well-structured), but it presents challenges for computers because they have difficulty comprehending the structure, making it unsuitable for data analysis. Despite this, there are still plenty of these analysis-resistant electronic data items in circulation.</p>
<p>Responding to this, in December 2020, the Ministry of Internal Affairs and Communications established a unified rule for the notation of machine-readable data <span class="citation" data-cites="soumu">(<a href="#ref-soumu" role="doc-biblioref">総務省 2020</a>)</span>. This includes the following checklist items.</p>
<ul>
<li>Is the file format either Excel or CSV?</li>
<li>Is each cell a single data unit?</li>
<li>Numerical data should be treated as numerical attributes, and should not include any characters.</li>
<li>Have you not merged cells?</li>
<li>Have you properly formatted your text with spaces and line breaks?</li>
<li>Have you not omitted the item names?</li>
<li>When using equations, check if they have been adapted to numerical data.</li>
<li>Not using the object Have you listed the units of the data?</li>
<li>Are you using any device-dependent characters?</li>
<li>Checking whether the data is fragmented or not Is there more than one table on a sheet?</li>
</ul>
<p>The basics of entering data can be said to involve <strong>creating a complete data set with information for one case on each line</strong>.</p>
<p>Similarly, the idea of <strong>Tidy Data</strong>, proposed by <span class="citation" data-cites="Hadley2014">Hadley (<a href="#ref-Hadley2014" role="doc-biblioref">2014</a>)</span>, relates to forms of data that are easier for a computer to analyze. Tidy Data refers to a data format with the following four characteristics:</p>
<ul>
<li>Each variable forms one column.</li>
<li>Each observation forms one row.</li>
<li>Each type of observational unit makes up one table.</li>
<li>Each value constitutes a single cell.</li>
</ul>
<p>With this format of data, it becomes easier for a computer to understand the correspondence structure of variables and values, resulting in data that is easier to analyze. It is no exaggeration to say that the purpose of data handling is to arrange cluttered, disparate data into a more user-friendly and organized format. Now, upon careful contemplation, one would notice that we can think of variable names as a type of variable in its own right. Generally, data in matrix format follows a specific format.</p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Morning | Afternoon | Evening | Late Night |</div>
<p>Sorry, but there wasn’t actually any Japanese text included in this task. Could you please provide the text you’d like me to translate? | Tokyo | Sunny | Sunny | Rain | Rain | | Osaka | Sunny | Cloudy | Sunny | Sunny | | Fukuoka | Sunny | Cloudy | Cloudy | Rainy |</p>
<p>: Long Format Data</p>
<p>For instance, if you want to check the evening weather in Osaka, it is apparent that it’s “sunny.” But your gaze moves in a manner that it references the row for Osaka and the column for Evening. Putting it differently, when you reference the “sunny” weather in Osaka in the evening, you’ll need to reference both row and column labels.</p>
<p>Let’s try rearranging the same data in the following way.</p>
<div class="line-block">Region | Time Zone | Weather |</div>
<p>Sure, could you kindly provide the Japanese text you’d like translated into English? | Tokyo | Morning | Sunny | | Tokyo | Afternoon | Clear |</p>
<div class="line-block">Tokyo | Evening | Rain |<br>
Tokyo | Midnight | Rain |</div>
<p>Without the original Japanese text, I’m unable to translate it into English for you. Could you please provide the text you want translated? | Osaka | Afternoon | Cloudy | I’m sorry, but without any context of what this Japanese text is related to, it’s quite difficult to provide a suitable translation. Your provided text consists of three Japanese words: “Osaka”, “evening”, and “clear” which are typical words you would see in a weather report. However, since it seems you want me to translate an academic text related to R and RStudio, additional information would be very helpful for me to give you a meaningful translation. Unfortunately, there’s no Japanese text in your request to translate. The only Japanese words are “Osaka” which is a city in Japan, “Shinya” which means “late at night”, and “Hare” which means “clear weather”. However, those don’t seem to constitute a full context or sentence that would make sense within the topic of psychological statistics using R and RStudio. Could you provide a more detailed context? Sure but you did not provide any Japanese text related to psychological statistics using R and RStudio to translate. The text you provided appears to be a table in a format of Markdown or RMarkdown, and it translates as follow:</p>
<div class="line-block">Fukuoka | Morning | Sunny |<br>
Fukuoka | Afternoon | Cloudy |</div>
<p>As you didn’t provide any Japanese text, here’s how the table you’ve given might be translated:</p>
<div class="line-block">Fukuoka | Evening | Cloudy |<br>
Fukuoka | Late Night | Rain |</div>
<p>: Long Format Data</p>
<p>While the information represented by this data is the same, narrowing down to the conditions of ‘Osaka’ and ‘evening’ could be done just by selecting rows, which is easy for computers. This format is referred to as ‘long format’ data, or ‘stacked’ data. Conversely, the earlier format is called ‘wide format’ data or ‘unstacked’ data.</p>
<p>One of the advantages of using long-format data is how it deals with missing values. When there are missing values in wide-format data, it’s often wasteful to delete the entire row or column. At the same time, it’s technically cumbersome to identify both rows and columns. In contrast, with long-format data, it’s sufficient to simply filter out and remove the relevant rows.</p>
<p>The <code>tidyverse</code> (more specifically, <code>tidyr</code>) includes built-in functions for converting between these long-format and wide-format data types. Let’s understand this concept with an example. First up is <code>pivot_longer</code>, which is used to convert wide-format data into long-format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 600 × 3
   Species name         value
   &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
 1 setosa  Sepal.Length   5.1
 2 setosa  Sepal.Width    3.5
 3 setosa  Petal.Length   1.4
 4 setosa  Petal.Width    0.2
 5 setosa  Sepal.Length   4.9
 6 setosa  Sepal.Width    3  
 7 setosa  Petal.Length   1.4
 8 setosa  Petal.Width    0.2
 9 setosa  Sepal.Length   4.7
10 setosa  Sepal.Width    3.2
# ℹ 590 more rows</code></pre>
</div>
</div>
<p>Here, we are reshaping the original <code>iris</code> data. We assign the <code>Species</code> cell as the key, and assign the rest of the variable names and their values to <code>name</code> and <code>value</code>, thus converting the data to long format.</p>
<p>Conversely, to switch from long-form data to wide-form data, use <code>pivot_wider</code>.</p>
<p>The example is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>ID) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> ID, <span class="at">names_from =</span> name, <span class="at">values_from =</span> value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 5
      ID Sepal.Length Sepal.Width Petal.Length Petal.Width
   &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1     1          5.1         3.5          1.4         0.2
 2     2          4.9         3            1.4         0.2
 3     3          4.7         3.2          1.3         0.2
 4     4          4.6         3.1          1.5         0.2
 5     5          5           3.6          1.4         0.2
 6     6          5.4         3.9          1.7         0.4
 7     7          4.6         3.4          1.4         0.3
 8     8          5           3.4          1.5         0.2
 9     9          4.4         2.9          1.4         0.2
10    10          4.9         3.1          1.5         0.1
# ℹ 140 more rows</code></pre>
</div>
</div>
<p>This time, we removed the <code>Species</code> variable and separately assigned row numbers as the <code>ID</code> variable. Using this row number as a key, we transformed the long format into a wide one by getting the variable names from the <code>names</code> column and their corresponding values from the <code>value</code> column<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
</section>
<section id="grouping-and-summary-statistics" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="grouping-and-summary-statistics"><span class="header-section-number">3.8</span> Grouping and Summary Statistics</h2>
<p>By transforming the data into long format, it becomes easier to narrow down variables and cases. Then, if you want to calculate summary statistics for each group, you can use <code>group_by</code> to group variables, and <code>summarise</code> or <code>reframe</code>. Let’s explore this through practical examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 5
# Groups:   Species [3]
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
 1          5.1         3.5          1.4         0.2 setosa 
 2          4.9         3            1.4         0.2 setosa 
 3          4.7         3.2          1.3         0.2 setosa 
 4          4.6         3.1          1.5         0.2 setosa 
 5          5           3.6          1.4         0.2 setosa 
 6          5.4         3.9          1.7         0.4 setosa 
 7          4.6         3.4          1.4         0.3 setosa 
 8          5           3.4          1.5         0.2 setosa 
 9          4.4         2.9          1.4         0.2 setosa 
10          4.9         3.1          1.5         0.1 setosa 
# ℹ 140 more rows</code></pre>
</div>
</div>
<p>In the code above, at first glance it may appear that there are no visible differences in the displayed data, but upon output, we see <code>Species[3]</code> displayed. This indicates that the Species variable is split into three groups. With this in mind, let’s try to use <code>summarise</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">mean</span>(Sepal.Length),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(Sepal.Length),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(Sepal.Length)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Species        n  Mean   Max   IQR
  &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 setosa        50  5.01   5.8 0.400
2 versicolor    50  5.94   7   0.7  
3 virginica     50  6.59   7.9 0.675</code></pre>
</div>
</div>
<p>In this section, we calculated the number of cases (<code>n</code>), the average (<code>mean</code>), the maximum value (<code>max</code>), and the interquartile range (<code>IQR</code>)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>In addition, while we have only calculated for <code>Sepal.Length</code> here, if you want to perform similar calculations for other numeric variables, you can use the <code>across</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(Sepal.Length, Sepal.Width, Petal.Length),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">mean</span>(.x)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Species    Sepal.Length Sepal.Width Petal.Length
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 setosa             5.01        3.43         1.46
2 versicolor         5.94        2.77         4.26
3 virginica          6.59        2.97         5.55</code></pre>
</div>
</div>
<p>Let’s note the usage of <code>~mean(.x)</code> here. In R language, this expression starting with a tilde (~) is particularly referred to as a lambda function or lambda expression. This is a way to create an ad hoc function for use in this context. Another way is to formally create a function using the <code>function</code> function, as can be written as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(Sepal.Length, Sepal.Width, Petal.Length),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) {</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(x)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Species    Sepal.Length Sepal.Width Petal.Length
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 setosa             5.01        3.43         1.46
2 versicolor         5.94        2.77         4.26
3 virginica          6.59        2.97         5.55</code></pre>
</div>
</div>
<p>We will touch upon how to create lambda functions and custom functions later, but for now, I want you to understand how to apply functions across multiple variables. In selecting variables with the <code>across</code> function, you can use others like <code>starts_with</code>, which we introduced when discussing the <code>select</code> function. The following example demonstrates how you can select multiple variables and apply multiple functions. You can provide lambda functions in a list to apply several functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Sepal"</span>),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">M =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Q1 =</span> <span class="sc">~</span> <span class="fu">quantile</span>(.x, <span class="fl">0.25</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Q3 =</span> <span class="sc">~</span> <span class="fu">quantile</span>(.x, <span class="fl">0.75</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  Species    Sepal.Length_M Sepal.Length_Q1 Sepal.Length_Q3 Sepal.Width_M
  &lt;fct&gt;               &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1 setosa               5.01            4.8              5.2          3.43
2 versicolor           5.94            5.6              6.3          2.77
3 virginica            6.59            6.22             6.9          2.97
# ℹ 2 more variables: Sepal.Width_Q1 &lt;dbl&gt;, Sepal.Width_Q3 &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="data-shaping-task" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="data-shaping-task"><span class="header-section-number">3.9</span> Data Shaping Task</h2>
<ul>
<li>We will utilize the <code>df2</code> object we created earlier. If the <code>df2</code> object is not retained in the environment, let’s go back to the previous task and recreate it.</li>
<li>Let’s group by Year and examine the number of registered players (the number of data) and average annual salary for each year. Let’s group by year and team, and look at the number of registered players (i.e., the count of data) and the average salary per year. Next, we want to create a wide format data, where each row represents one fiscal year and columns represent a combination of different teams and variables. Let’s try converting our previously created object to a wide format data using <code>pivot_wider</code>.</li>
<li>Let’s try to transform the data that has become wide-format into long-format data using the <code>pivot_longer</code> function, with <code>Year</code> as the key.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Hadley2014" class="csl-entry" role="listitem">
Hadley, Wickham. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59: 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
<div id="ref-soumu" class="csl-entry" role="listitem">
総務省. 2020. <span>“統計表における機械判別可能なデータ作成に関する表記方法.”</span> 統計企画会議申し合わせ. <a href="https://www.soumu.go.jp/main_content/000723697.pdf">https://www.soumu.go.jp/main_content/000723697.pdf</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Of course, this could be done in one line with <code>sd(dat)</code>, but each step is written out here for explanation purposes. Moreover, what is calculated with the <code>sd</code> function is the square root of the unbiased variance divided by <span class="math inline">\(n-1\)</span>, which is different from the sample standard deviation.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The reason we excluded the <code>Species</code> variable is because we can’t transform the data from long to wide format using it as the key (since Species has only three levels), and a separate ID was needed to distinguish individual cases. This led to the loss of Species information, due to the limitation that the <code>value</code> column of long format data cannot accommodate both <code>char</code> and <code>double</code> types at the same time. To overcome this issue, a potential workaround could be converting Factor type data into numerical format using the <code>as.numeric()</code> function.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The Interquartile Range (IQR) refers to the range obtained by subtracting the value of the top 3/4 from the value of the top 1/4 when the data is divided into four parts in the order of values.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter02.html" class="pagination-link  aria-label=" &lt;span="" of="" r&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentals of R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter04.html" class="pagination-link" aria-label="<span class='chapter-number'>4</span>&nbsp; <span class='chapter-title'>Creating Reports with R</span>">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating Reports with R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>